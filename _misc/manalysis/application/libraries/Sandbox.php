<?php
/**
 * Data Submission to Sanbox servers as per the protocol
 * 
 * COnfiguration saved in application/config/sanbox_config.php
 * 
 */
class Sandbox{

	private $_malware_save_path;
	
	public function __construct(){
		$this->_malware_save_path = 'dionaea_binaries';
	}
	
	public function send($protocol, $url, $file, $email){
		$response = NULL;
		switch($protocol){

			default:
			case 'http':
				//Use curl
				$response = shell_exec('curl -X POST -F "upfile=@'.$this->_malware_save_path.'/'.$file.'" -F "email='.$email.'" '.$url);
				break;


		}
		return $response;
	}


	public function fetch_report($protocol, $url, $file_name){
		$response = NULL;
		
		switch ($protocol){
			
			default:
			case 'http':
				$response = shell_exec('curl --silent '.$url.' | grep \''.$file_name.'\'');
				break;
			
			
		}
		return $response;
		
		
	}













}

?>