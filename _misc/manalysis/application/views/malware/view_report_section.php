<?php //p($nodes);p($node_values)?>
<style type="text/css">
td{
	font-size:9px;
	font-family:verdana;
}
table.sectionTable {
    background-color: white;
    border: 1px solid #000000;
    border-collapse: collapse;
    width: 100%;
}
table.sectionTable td.subtableheader {
    background-color: #D0DFFB;
    border-bottom: 1px solid #000000;
    font-family: Verdana;
    font-size: 11px;
    font-weight: bold;
    padding-left: 3px;
    /*text-align: left;*/
}
table.sectionTable td {
    border-bottom: 1px dotted #6699CC;
    color: #404040;
    font-family: Verdana,sans-serif,Arial;
    font-size: 11px;
    font-weight: normal;
    padding-left: 3px;
    /*text-align: left;*/
}

</style>
<link rel="stylesheet" href="<?php echo base_url();?>assets/js/jquery-1.6.2.min.js" />

<?php if($section === 'dll_handling_section'):?>
<h3><?php echo ucwords(str_replace('_', ' ', $section));?></h3>
<table cellpadding="10" cellspacing="10" border="0" width="80%" class="sectionTable">
<tr>
		<td class="subtableheader" width="10%">Action</td>
		<td class="subtableheader" width="30%" align="left">Filename</td>
		<td class="subtableheader" align="center">Address</td>
		<td class="subtableheader" align="center">End Address</td>
		<td class="subtableheader" align="center">Successful</td>
		<td class="subtableheader" align="center">Size</td>
		<td class="subtableheader"  align="center">Quantity</td>
		
	</tr>
<?php foreach ($nodes as $n => $section_name):?>
	
	
	<?php //foreach($node_values[$n] as $key => $val):?>
	<tr>
		<td><?php echo ucwords(str_replace('_',' ', $section_name));?></td>
		<td><?php if (isset($node_values[$n]['filename']) || array_key_exists('filename', $node_values[$n])) echo $node_values[$n]['filename'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['address']) || array_key_exists('address', $node_values[$n])) echo $node_values[$n]['address'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['end_address']) || array_key_exists('end_address', $node_values[$n])) echo $node_values[$n]['end_address'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['successful']) || array_key_exists('successful', $node_values[$n])) echo $node_values[$n]['successful'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['size']) || array_key_exists('size', $node_values[$n])) echo $node_values[$n]['size'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['quantity']) || array_key_exists('quantity', $node_values[$n])) echo $node_values[$n]['quantity'];?></td>
	</tr>

<?php endforeach;?>

</table>
<?php endif;?>
<?php if($section === 'filesystem_section'):?>
<h3><?php echo ucwords(str_replace('_', ' ', $section));?></h3>
<table cellpadding="10" cellspacing="10" border="0" width="100%" class="sectionTable">
<tr>
		<td class="subtableheader" width="100px">Action</td>
		<td class="subtableheader" width="5%" align="left">Filetype</td>
		<td class="subtableheader" align="left" width="30%">Srcfile</td>
		<td class="subtableheader" align="center">Desiredaccess</td>
		<td class="subtableheader" align="center">Flags</td>
		<td class="subtableheader" align="center">Creationdistribution</td>
		<td class="subtableheader" align="center">Shareaccess</td>
		<td class="subtableheader"  align="center">Dstfile</td>
		<td class="subtableheader"  align="center">Stored As</td>
		
	</tr>
<?php foreach ($nodes as $n => $section_name):?>
	
	
	<?php //foreach($node_values[$n] as $key => $val):?>
	<tr>
		<td><?php echo ucwords(str_replace('_',' ', $section_name));?></td>
		<td><?php if (isset($node_values[$n]['filetype']) || array_key_exists('filetype', $node_values[$n])) echo $node_values[$n]['filetype'];?></td>
		<td align="left"><?php if (isset($node_values[$n]['srcfile']) || array_key_exists('srcfile', $node_values[$n])) echo $node_values[$n]['srcfile'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['desiredaccess']) || array_key_exists('desiredaccess', $node_values[$n])) echo $node_values[$n]['desiredaccess'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['flags']) || array_key_exists('flags', $node_values[$n])) echo $node_values[$n]['flags'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['creationdistribution']) || array_key_exists('creationdistribution', $node_values[$n])) echo $node_values[$n]['creationdistribution'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['shareaccess']) || array_key_exists('shareaccess', $node_values[$n])) echo $node_values[$n]['shareaccess'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['dstfile']) || array_key_exists('dstfile', $node_values[$n])) echo $node_values[$n]['dstfile'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['stored_as']) || array_key_exists('stored_as', $node_values[$n])) echo $node_values[$n]['stored_as'];?></td>
	</tr>

<?php endforeach;?>

</table>
<?php endif;?>
<?php if($section === 'mutex_section'):?>
<h3><?php echo ucwords(str_replace('_', ' ', $section));?></h3>
<table cellpadding="10" cellspacing="10" border="0" width="50%" class="sectionTable">
<tr>
		<td class="subtableheader" width="100px">Action</td>
		<td class="subtableheader"  align="center">Name</td>
		<td class="subtableheader" align="center" >Owned</td>
		
	</tr>
<?php foreach ($nodes as $n => $section_name):?>
	
	
	<?php //foreach($node_values[$n] as $key => $val):?>
	<tr>
		<td><?php echo ucwords(str_replace('_',' ', $section_name));?></td>
		<td align="center"><?php if (isset($node_values[$n]['name']) || array_key_exists('name', $node_values[$n])) echo $node_values[$n]['name'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['owned']) || array_key_exists('owned', $node_values[$n])) echo $node_values[$n]['owned'];?></td>
	</tr>

<?php endforeach;?>

</table>
<?php endif;?>

<?php if($section === 'registry_section'):?>
<h3><?php echo ucwords(str_replace('_', ' ', $section));?></h3>
<table cellpadding="10" cellspacing="10" border="0" width="50%" class="sectionTable">
<tr>
		<td class="subtableheader" width="100px">Action</td>
		<td class="subtableheader"  align="left">Key</td>
		<td class="subtableheader" align="left" >Value</td>
		<td class="subtableheader" align="left" >Data</td>
		<td class="subtableheader" align="center" >Quantity</td>
	</tr>
<?php foreach ($nodes as $n => $section_name):?>
	
	
	<?php //foreach($node_values[$n] as $key => $val):?>
	<tr>
		<td><?php echo ucwords(str_replace('_',' ', $section_name));?></td>
		<td align="left"><?php if (isset($node_values[$n]['key']) || array_key_exists('key', $node_values[$n])) echo $node_values[$n]['key'];?></td>
		<td align="left"><?php if (isset($node_values[$n]['value']) || array_key_exists('value', $node_values[$n])) echo $node_values[$n]['value'];?></td>
		<td align="left"><?php if (isset($node_values[$n]['data']) || array_key_exists('data', $node_values[$n])) echo $node_values[$n]['data'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['quantity']) || array_key_exists('quantity', $node_values[$n])) echo $node_values[$n]['quantity'];?></td>
	</tr>

<?php endforeach;?>

</table>
<?php endif;?>

<?php if(in_array($section,array('process_section','system_section','system_info_section','stored_created_files_section','thread_section','window_section','user_section','com_section', 'basic_info','ini_file_section','inet_helper_section','service_section','thread_section','windows_hook_section'))):?>
<h3><?php echo ucwords(str_replace('_', ' ', $section));?></h3>
<table cellpadding="10" cellspacing="10" border="0" width="50%" class="sectionTable">

<?php foreach ($nodes as $n => $section_name):?>
	
	
	<?php //foreach($node_values[$n] as $key => $val):?>
	<tr>
		<td><?php echo ucwords(str_replace('_',' ', $section_name));?></td>
		<td align="left">
			<table cellpadding="2" cellspacing="5" border="0" align="left">
			
			<?php foreach ($node_values[$n] as $key => $val):?>
				<tr>
					<td width="30%" style="border-bottom:none;"><?php echo $key;?></td><td style="border-bottom:none;">"<?php echo $val;?>"</td>
				</tr>	
			<?php endforeach;?>		
			
			</table>
		</td>
	</tr>

<?php endforeach;?>

</table>
<?php endif;?>

<?php if($section === 'virtual_memory_section'):?>
<h3><?php echo ucwords(str_replace('_', ' ', $section));?></h3>
<table cellpadding="10" cellspacing="10" border="0" width="50%" class="sectionTable">
<tr>
		<td class="subtableheader" width="100px">Action</td>
		<td class="subtableheader"  align="left">Target PID</td>
		<td class="subtableheader" align="left" >Wanted Address</td>
		<td class="subtableheader" align="left" >Address</td>
		<td class="subtableheader" align="center" >Wanted Size</td>
		<td class="subtableheader" align="center" >Size</td>
		<td class="subtableheader" align="center" >Protect</td>
		<td class="subtableheader" align="center" >Allocation Type</td>
		<td class="subtableheader" align="center" >Behavior</td>
	</tr>
<?php foreach ($nodes as $n => $section_name):?>
	
	
	<?php //foreach($node_values[$n] as $key => $val):?>
	<tr>
		<td><?php echo ucwords(str_replace('_',' ', $section_name));?></td>
		<td align="left"><?php if (isset($node_values[$n]['targetpid']) || array_key_exists('targetpid', $node_values[$n])) echo $node_values[$n]['targetpid'];?></td>
		<td align="left"><?php if (isset($node_values[$n]['wantedaddress']) || array_key_exists('wantedaddress', $node_values[$n])) echo $node_values[$n]['wantedaddress'];?></td>
		<td align="left"><?php if (isset($node_values[$n]['address']) || array_key_exists('address', $node_values[$n])) echo $node_values[$n]['address'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['wantedsize']) || array_key_exists('wantedsize', $node_values[$n])) echo $node_values[$n]['wantedsize'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['size']) || array_key_exists('size', $node_values[$n])) echo $node_values[$n]['size'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['protect']) || array_key_exists('protect', $node_values[$n])) echo $node_values[$n]['protect'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['allocationtype']) || array_key_exists('allocationtype', $node_values[$n])) echo $node_values[$n]['allocationtype'];?></td>
		<td align="center"><?php if (isset($node_values[$n]['behavior']) || array_key_exists('behavior', $node_values[$n])) echo $node_values[$n]['behavior'];?></td>
	</tr>

<?php endforeach;?>

</table>
<?php endif;?>

<?php if($section === 'winsock_section'):?>
<h3><?php echo ucwords(str_replace('_', ' ', $section));?></h3>
<ul>
<?php if(count($unknown_connections) > 0):?>
<h5>Unknown Connections</h4>
<?php foreach ($unknown_connections as $uc):?>
		<li style="margin-left:20px;">
			<?php foreach ($uc['attributes'] as $key => $val):
					echo '<strong>'.$key.':</strong>'.$val.'; ';
				  endforeach;
			?>
			<table cellpadding="5" cellspacing="3" border="0" width="50%" class="sectionTable">
			<tr>
				<td class="subtableheader"  align="left">Requested Host</td>
				<td class="subtableheader" align="left" >Resulting Addr</td>
				<td class="subtableheader" align="left" >More Resulting Addr</td>
				<td class="subtableheader" align="left" >Error Code</td>
			</tr>
			<?php foreach ($uc['hosts'] as $host):?>
			<tr>
				<td align="left"><?php if (isset($host['requested_host']) || array_key_exists('requested_host', $host)) echo $host['requested_host'];?></td>
				<td align="left"><?php if (isset($host['resulting_addr']) || array_key_exists('resulting_addr', $host)) echo $host['resulting_addr'];?></td>
				<td align="left"><?php if (isset($host['more_resulting_addr']) || array_key_exists('more_resulting_addr', $host)) echo $host['more_resulting_addr'];?></td>
				<td align="left"><?php if (isset($host['error_code']) || array_key_exists('error_code', $host)) echo $host['error_code'];?></td>
			</tr>
			<?php endforeach;?>
		</li>
<?php endforeach;?>
<?php endif;?>

</ul>
<?php endif;?>