<?php if($network_info):?>
<?php $display = 0;?>
<div id="network_info">
	<?php foreach ($network_info as $index => $info):?>
	<?php //p($info);?>
		<?php list($pIndex,$pid) = explode('#',$index);?>
		<?php if(!empty($info['socket_info']) || !empty($info['conn_unknown_info']) || !empty($info['udp_info'])  || !empty($info['tcp_nonhttp_info'])  || !empty($info['tcp_http_info']) || !empty($info['dns_info'])):?>
			<?php $display = 1;?>
			<div class="info_heading">Process #<?php echo $pIndex;?>&nbsp;(<?php echo $pid;?>)</div>
			<?php if(!empty($info['socket_info'])):?>
				<div class="expandable"><a href="#">Socket Information</a></div>
					<div class="expandable_info">
						<table cellpadding="5" cellspacing="0" border="1" width="100%">
							<tr>
								<td valign="top"><b>Socket</b></td>
								<td valign="top"><b>Type</b></td>
								<td valign="top"><b>Remote Addr</b></td>
								<td valign="top"><b>Remote Port</b></td>
								<td><b>Send Data</b></td>
								<td width="30%"><b>Recv Data</b></td>
							</tr>
							<?php foreach ($info['socket_info'] as $socket_info): ?>
							<tr>
								<td valign="top"><?php echo $socket_info['socket'];?></td>							
								<td valign="top"><?php echo $socket_info['socket_type'];?></td>
								<?php if(!empty($socket_info['connection_details'])):?>
										<td valign="top"><?php echo $socket_info['connection_details'][0]['remote_addr'];?></td>							
										<td valign="top"><?php echo $socket_info['connection_details'][0]['remote_port'];?></td>							
										<td valign="top"><?php echo $socket_info['connection_details'][0]['send_data'];?></td>		
										<td width="30%" valign="top"><?php echo wordwrap($socket_info['connection_details'][0]['recv_data'],98," <br>\n", TRUE);?></td>		
								<?php else:?>
								<td><i>undefined</i></td>							
								<td><i>undefined</i></td>							
								<td><i>undefined</i></td>
								<td><i>undefined</i></td>
								<?php endif;?>
							</tr>	
							<?php endforeach;?>
						</table>
					</div>
			<?php endif;// End of Socket info?>
			<?php if(!empty($info['conn_unknown_info'])): // Unknown Info?>
				<div class="expandable"><a href="#">Unknown Connections</a></div>
				<div class="expandable_info">
					<table cellpadding="5" cellspacing="0" border="1" width="100%">
						<tr>
							<td valign="top"><b>Host Name</b></td>
							<td valign="top"><b>Remote Address</b></td>
							<td valign="top"><b>Error Code</b></td>
						</tr>
						<?php foreach ($info['conn_unknown_info'] as $unknown_info):?>
							<tr>
								<td><?php echo $unknown_info['requested_host'];?></td>
								<td><?php echo $unknown_info['resulting_addr'];?></td>
								<td><?php echo $unknown_info['error_code'];?></td>
							</tr>
						<?php endforeach;?>
					</table>		
				</div>
			<?php endif;?>
			<?php if(!empty($info['udp_info'])): // UDP Info?>
				<div class="expandable"><a href="#">UDP Connections</a></div>
				<div class="expandable_info">
					<table cellpadding="5" cellspacing="0" border="1" width="100%">
						<tr>
							<td valign="top"><b>Remote Address</b></td>
							<td valign="top"><b>Remote Port</b></td>
							<td valign="top"><b>Size</b></td>
							<td valign="top"><b>Send Data</b></td>
						</tr>
						<?php foreach ($info['udp_info'] as $udp_info):?>
							<tr>
								<td><?php echo $udp_info['remoteaddr'];?></td>
								<td><?php echo $udp_info['remoteport'];?></td>
								<td><?php echo $udp_info['size'];?></td>
								<td><?php echo $udp_info['send_data'];?></td>
							</tr>
						<?php endforeach;?>
					</table>		
				</div>
			<?php endif;  // UDP info?>
			<?php if(!empty($info['tcp_nonhttp_info'])): // TCP Non-HTTP Info?>
				<div class="expandable"><a href="#">TCP Connections (Non-HTTP)</a></div>
				<div class="expandable_info">
					<table cellpadding="5" cellspacing="0" border="1" width="100%">
						<tr>
							<td valign="top"><b>Remote Address</b></td>
							<td valign="top"><b>Remote Port</b></td>
							<td valign="top"><b>Protocol</b></td>
							<td valign="top"><b>Connection Established</b></td>
							<td valign="top"><b>Socket</b></td>
							<td valign="top"><b>Send Data</b></td>
							<td valign="top"><b>Recv Data</b></td>
						</tr>
						<?php foreach ($info['tcp_nonhttp_info'] as $nonhttp_info):?>
							<tr>
								<td valign="top"><?php echo $nonhttp_info['remoteaddr'];?></td>
								<td valign="top"><?php echo $nonhttp_info['remoteport'];?></td>
								<td valign="top"><?php echo isset($nonhttp_info['protocol']) ? $nonhttp_info['protocol'] : '';?></td>
								<td valign="top"><?php echo $nonhttp_info['connectionestablished'];?></td>
								<td valign="top"><?php echo $nonhttp_info['socket'];?></td>
								<td valign="top"><?php echo wordwrap($nonhttp_info['send_data'],50," <br>\n", TRUE);?></td>
								<td valign="top"><?php echo wordwrap($nonhttp_info['recv_data'],50," <br>\n", TRUE);?></td>
							</tr>
						<?php endforeach;?>
					</table>		
				</div>
			<?php endif;?>
			<?php if(!empty($info['tcp_http_info'])): // TCP HTTP Info?>
				<div class="expandable"><a href="#">TCP Connections (HTTP)</a></div>
				<div class="expandable_info">
					<table cellpadding="5" cellspacing="0" border="1" width="100%">
						<tr>
							<td valign="top"><b>Remote Address</b></td>
							<td valign="top"><b>Remote Port</b></td>
							<td valign="top"><b>Protocol</b></td>
							<td valign="top"><b>Connection Established</b></td>
							<td valign="top"><b>Socket</b></td>
							<td valign="top"><b>Method</b></td>
							<td valign="top"><b>URL</b></td>
							<td valign="top"><b>HTTP Version</b></td>
							<td valign="top"><b>Headers</b></td>
							<td valign="top"><b>Send Data</b></td>
							<td valign="top"><b>Recv Data</b></td>
						</tr>
						<?php foreach ($info['tcp_http_info'] as $http_info):?>
							<tr>
								<td valign="top"><?php echo $http_info['remoteaddr'];?></td>
								<td valign="top"><?php echo $http_info['remoteport'];?></td>
								<td valign="top"><?php echo isset($http_info['protocol']) ? $http_info['protocol'] : '';?></td>
								<td valign="top"><?php echo $http_info['connectionestablished'];?></td>
								<td valign="top"><?php echo $http_info['socket'];?></td>
								<td valign="top"><?php echo $http_info['method'];?></td>
								<td valign="top"><?php echo $http_info['url'];?></td>
								<td valign="top"><?php echo $http_info['http_version'];?></td>
								<td valign="top"><?php echo $http_info['headers'];?></td>
								<td valign="top"><?php echo wordwrap($http_info['send_data'],50," <br>\n", TRUE);?></td>
								<td valign="top"><?php echo wordwrap($http_info['recv_data'],50," <br>\n", TRUE);?></td>
							</tr>
						<?php endforeach;?>
					</table>		
				</div>
			<?php endif;?>
			<?php if(!empty($info['dns_info'])): // DNS Info?>
				<div class="expandable"><a href="#">DNS Information</a></div>
				<div class="expandable_info">
					<table cellpadding="5" cellspacing="0" border="1" width="50%">
						<tr>
							<td valign="top"><b>Remote Address</b></td>
							<td valign="top"><b>Hostname Port</b></td>
						</tr>
						<?php foreach ($info['dns_info'] as $dns_info):?>
							<tr>
								<td valign="top"><?php echo $dns_info['remote_addr'];?></td>
								<td valign="top"><?php echo $dns_info['hostname'];?></td>
							</tr>
						<?php endforeach;?>
					</table>		
				</div>
			<?php endif;?>
		<?php endif; ?>	
			
			
			
		<?php endforeach;?>
		
<script type="text/javascript">
$('.expandable').click(function () {
	$(this).toggleClass('contract');
	$(this).next().slideToggle('slow');
	return false;
});
</script>	
</div>
		<?php if($display == 0):?>
			<div class="info">Sorry dude, nothing to display here!</div>
		<?php endif;?>
<?php endif;?>