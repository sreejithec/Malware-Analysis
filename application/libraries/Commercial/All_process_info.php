<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');
include APPPATH.'libraries/Commercial.php';
class All_process_info extends Commercial {
	private $_process_list = array();
	
	public function __construct($config=array()){
		if(!empty($config)){
			$this->initialize($config);
		}
	}
	
	public function get_process_list(){
		if(empty($this->_process_list)){
			$this->_process_list = $this->get_processes();
		}
		return  $this->_process_list;
		
	}
	
	
	public function get_all_info(){
		$data = array();
		$processes = $this->get_process_list();
		foreach ($processes as $p){
			$data[$p['index'].'#'.$p['pid']] = $this->get_all_process_info($p['index']);
		}
		return $data;
	}
	
	
	public function get_all_process_info($index){
		$d = $data = array();
		$process_node = $this->_xml->xpath('/analysis/processes/process[@index="'.$index.'"]');
		if($process_node){
			$data['process_details'] = $this->get_attributes($process_node[0]);
			foreach ($process_node[0] as $section => $section_node){
				//$data[$section]
				if($section_node->count() > 0){
					$section_children = $section_node->children();
					foreach ($section_children as $sub_section => $sub_section_node){
						$data[$section][$sub_section][] = $this->get_attributes($sub_section_node);
					}

				}
			}
		}
		return $data;
	}
	
}

?>