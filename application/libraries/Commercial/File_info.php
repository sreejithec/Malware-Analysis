<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');
include APPPATH.'libraries/Commercial.php';
class File_info extends Commercial {

	public function __construct($config=array()){
		if(!empty($config)){
			$this->initialize($config);
		}
	}
	
	public function get_process_file_info(){
		$file_info = array();
		$processes = $this->get_processes();
		foreach ($processes as $index => $process){
			$file_info_node = (array)$this->_xml->xpath('/analysis/processes/process[@index="'.$index.'"]/filesystem_section');		
			if(isset($file_info_node[0])){
				$file_info[$index.'#'.$process['pid']] = (array)$file_info_node[0];
			}
		}
		return $file_info;
	}
	
	
}
?>