<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');
include APPPATH.'libraries/Commercial.php';
class Registry_info extends Commercial {

	public function __construct($config=array()){
		if(!empty($config)){
			$this->initialize($config);
		}
	}
	
	public function get_process_reg_info(){
		$reg_info = array();
		$processes = $this->get_processes();
		foreach ($processes as $index => $process){
			$reg_info_node = (array)$this->_xml->xpath('/analysis/processes/process[@index="'.$index.'"]/registry_section');		
			if(isset($reg_info_node[0])){
				$reg_info[$index.'#'.$process['pid']] = (array)$reg_info_node[0];
			}
		}
		return $reg_info;
	}
	
	
}
?>