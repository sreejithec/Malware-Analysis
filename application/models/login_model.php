<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');
/**
 * Model that validates the email and password of the user.
 * MD5 algorithm is used for storing password.
 * 
 * @package MalwareAnalysis
 */
class Login_Model extends CI_Model {

	/**
	 * Name of the mail table that this model deals with
	 * @access private
	 */
	private $_table;
	
	/**
	 * Construct for Login_Model
	 *
	 */
	public function __construct() {
		parent::__construct();
		$this->_table = 'tbl_admin';
	}


	/**
	* Validate the username and password in the database
	* 
	* @access public
	* @param : $mail string
	* @param : $pass string
	* @return : bool
	*
	*/
	public function validate($email, $pass){
		$sql = 'SELECT * FROM '.$this->_table.' WHERE email = ? AND password = ? AND active = ? LIMIT 1';
		$result = $this->db->query($sql, array($email, md5($pass), 1));
		if($result->num_rows() > 0){
			return $result->row();
		}
		return FALSE;
	}

}
?>